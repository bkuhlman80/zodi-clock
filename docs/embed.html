<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Z0DI Clock â€” Embed</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />

  <!-- Scripts -->
  <script>
  (function loadAstronomy(i=0){
    const srcs = [
      "https://cdn.jsdelivr.net/npm/astronomy-engine@2/astronomy.browser.min.js",
      "https://unpkg.com/astronomy-engine@2/astronomy.browser.min.js",
      "https://esm.run/astronomy-engine@2/astronomy.browser.min.js"
    ];
    if (i >= srcs.length) { console.error("Astronomy failed to load"); return; }
    const s = document.createElement("script");
    s.defer = true;
    s.src = srcs[i] + "?v=20250906";
    s.onload = () => console.log("Astronomy loaded from", s.src, !!window.Astronomy);
    s.onerror = () => { console.warn("fail", s.src); loadAstronomy(i+1); };
    document.head.appendChild(s);
    })();
  </script>
  <script defer src="./clock.js?v=20250906-1"></script>


  <!-- Slim host styling -->
  <style>
    html,body { margin:0; background:#0f1218; color:#e6e7eb;
                font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; }
  </style>
</head>
<body>
  <!-- The component reads attributes set below (mode/dt/controls/labels) -->
  <zodi-clock style="display:block;width:100%;max-width:2000px;"></zodi-clock>

  <script>
    // Read URL params and pass to the component as attributes
    const p = new URLSearchParams(location.search);
    const initialMode = p.get("mode") || "frozen";          // "animated" | "frozen"
    const dtParam     = p.get("dt");                        // ISO string (UTC), e.g. 2025-08-19T03:11:00Z
    const controls    = p.get("controls") ?? "0";           // "0" hide controls (default) | "1" show
    const labels      = p.get("labels")   ?? "1";           // "1" show labels (default) | "0" hide

    customElements.whenDefined("zodi-clock").then(() => {
      const el = document.querySelector("zodi-clock");
      el.setAttribute("embed", "1");
      el.setAttribute("controls", controls);
      el.setAttribute("labels", labels);
      el.setAttribute("initial-mode", initialMode);
      if (dtParam) el.setAttribute("initial-dt", dtParam);
    });
  </script>
</body>
</html>
